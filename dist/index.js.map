{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/GOLMatrix.ts","webpack:///./src/index.ts","webpack:///./src/GOLDrawingUtils.ts","webpack:///./node_modules/anim-loop-engine/lib/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","cellSize","GameOfLifeMatrix","gridSize","this","liveCells","setCellLive","cellMatrix","x","y","getCellState","isAlive","numNeighbours","j","nY","nX","iterate","nextCells","state","setCellState","alive","updateCells","drawBgCell","ctx","beginPath","rect","fill","clearCells","W","H","clearRect","drawBgGrid","fillStyle","drawLiveCells","numI","parseInt","numJ","engine","animate","frameReqId","frameTasks","lastFrameTaskId","loop","ts","numTasks","length","fn","requestAnimationFrame","addTasks","task","tasks","createdIds","forEach","push","id","taskId","filter","debugInterval","cancelAnimationFrame","lastMouseBtn","mouseBtn","running","loopInterval","drawX","drawY","onChangeTimeoutId","GOL","btnToggle","document","getElementById","txtGridSize","txtInterval","bgCanvas","canvas","bgCtx","getContext","toString","getBoundingClientRect","canvasStyle","window","getComputedStyle","width","height","setAttribute","style","onclick","stop","start","onkeyup","e","clearTimeout","setTimeout","newGridSize","target","onblur","handleMouseDraw","gridX","Math","floor","clientX","left","gridY","clientY","top","addEventListener","preventDefault","onmousedown","button","onmousemove","onmouseup","tsFrom","innerHTML","addTask"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","var GameOfLifeMatrix = /** @class */ (function () {\r\n    function GameOfLifeMatrix(gridSize) {\r\n        this.gridSize = gridSize;\r\n        this.liveCells = [];\r\n        // Set a cell live, initializing a matrix row if needed\r\n        this.setCellLive = function (cellMatrix, x, y) {\r\n            cellMatrix[y] = cellMatrix[y] || [];\r\n            cellMatrix[y][x] = 1;\r\n        };\r\n    }\r\n    // Get a cell's state; it's alive status plus neighbour count\r\n    GameOfLifeMatrix.prototype.getCellState = function (x, y) {\r\n        var isAlive = this.liveCells[y] && this.liveCells[y][x];\r\n        var numNeighbours = 0;\r\n        // Check a range from -1 to +1 from this cell, both axes\r\n        for (var i = -1; i <= 1; i++) {\r\n            for (var j = -1; j <= 1; j++) {\r\n                if (i === 0 && j === 0) {\r\n                    continue;\r\n                }\r\n                // Get neighbour cell position to check\r\n                var nY = y + i;\r\n                var nX = x + j;\r\n                // If out of bounds, wrap around\r\n                if (nY < 0) {\r\n                    nY = this.gridSize - 1;\r\n                }\r\n                else if (nY >= this.gridSize) {\r\n                    nY = 0;\r\n                }\r\n                if (nX < 0) {\r\n                    nX = this.gridSize - 1;\r\n                }\r\n                else if (nX >= this.gridSize) {\r\n                    nX = 0;\r\n                }\r\n                // If a neighbour exists here increment neighbour count\r\n                if (this.liveCells[nY] && this.liveCells[nY][nX]) {\r\n                    numNeighbours++;\r\n                }\r\n            }\r\n        }\r\n        return { isAlive: isAlive, numNeighbours: numNeighbours };\r\n    };\r\n    // Perform an iteration, in life terms, a generation\r\n    GameOfLifeMatrix.prototype.iterate = function () {\r\n        var nextCells = [];\r\n        // Sweep the whole grid\r\n        for (var i = 0; i < this.gridSize; i++) {\r\n            for (var j = 0; j < this.gridSize; j++) {\r\n                // Get cell state\r\n                var state = this.getCellState(j, i);\r\n                if (\r\n                // If it's alive with 2 or 3 neighbours, stay alive\r\n                (state.isAlive &&\r\n                    state.numNeighbours >= 2 &&\r\n                    state.numNeighbours <= 3) ||\r\n                    // Or if not alive with 3 neighbours, spring into life\r\n                    (!state.isAlive && state.numNeighbours === 3)) {\r\n                    this.setCellLive(nextCells, j, i);\r\n                }\r\n            }\r\n        }\r\n        this.liveCells = nextCells;\r\n    };\r\n    // Set a cell's state\r\n    GameOfLifeMatrix.prototype.setCellState = function (x, y, alive) {\r\n        var updateCells = [];\r\n        // Loop through the grid, clicked to live, keep live cells we didn't click\r\n        for (var i = 0; i < this.gridSize; i++) {\r\n            // Skip unclicked empty row\r\n            if (!this.liveCells[i] && i !== y) {\r\n                continue;\r\n            }\r\n            // Copy any existing row cells\r\n            updateCells[i] = this.liveCells[i] || [];\r\n            for (var j = 0; j < this.gridSize; j++) {\r\n                if (i === y && j === x) {\r\n                    if (alive) {\r\n                        this.setCellLive(updateCells, j, i);\r\n                    }\r\n                    else if (updateCells[i]) {\r\n                        delete updateCells[i][j];\r\n                    }\r\n                }\r\n                else {\r\n                    if (this.liveCells[i] && this.liveCells[i][j]) {\r\n                        this.setCellLive(updateCells, j, i);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.liveCells = updateCells;\r\n    };\r\n    return GameOfLifeMatrix;\r\n}());\r\nexport { GameOfLifeMatrix };\r\n","import { AnimLoopEngine } from 'anim-loop-engine';\r\nimport { GameOfLifeMatrix } from './GOLMatrix';\r\nimport { clearCells, drawBgGrid, drawLiveCells } from './GOLDrawingUtils';\r\nvar engine = new AnimLoopEngine();\r\n// Defaults, declarations and elements\r\nvar cellSize;\r\nvar lastMouseBtn = 0;\r\nvar mouseBtn = 0;\r\nvar running = false;\r\nvar loopInterval = 150;\r\nvar gridSize = 20;\r\nvar drawX = 0;\r\nvar drawY = 0;\r\nvar onChangeTimeoutId = 0;\r\nvar GOL = new GameOfLifeMatrix(gridSize);\r\nvar btnTextActive = 'PAUSE';\r\nvar btnTextInactive = 'RUN';\r\nvar btnToggle = document.getElementById('btn-toggle-sim');\r\nvar txtGridSize = document.getElementById('txt-grid-size');\r\nvar txtInterval = document.getElementById('txt-interval');\r\nvar bgCanvas = document.getElementById('g-o-l-bg');\r\nvar canvas = document.getElementById('g-o-l');\r\nvar bgCtx = bgCanvas.getContext('2d');\r\nvar ctx = canvas.getContext('2d');\r\n// Assign defaults to control input fields\r\ntxtGridSize.value = gridSize.toString();\r\ntxtInterval.value = loopInterval.toString();\r\n// >>> Setup canvas\r\nvar rect = canvas.getBoundingClientRect();\r\nvar canvasStyle = window.getComputedStyle(canvas);\r\nvar W = parseInt(canvasStyle.width);\r\nvar H = parseInt(canvasStyle.height);\r\nbgCanvas.setAttribute('width', canvasStyle.width);\r\ncanvas.setAttribute('width', canvasStyle.width);\r\nif (W < H) {\r\n    bgCanvas.style.height = canvasStyle.width;\r\n    canvas.style.height = canvasStyle.width;\r\n    bgCanvas.setAttribute('height', canvasStyle.width);\r\n    canvas.setAttribute('height', canvasStyle.width);\r\n}\r\nelse {\r\n    bgCanvas.setAttribute('height', canvasStyle.height);\r\n    canvas.setAttribute('height', canvasStyle.height);\r\n}\r\n// Set grid cell size based on canvas width and number of divisions\r\ncellSize = W / gridSize;\r\n// >>> Game control events\r\n// Run/pause button toggle\r\nbtnToggle.onclick = function () {\r\n    if (!running) {\r\n        start();\r\n    }\r\n    else {\r\n        stop();\r\n    }\r\n};\r\n// Grid size value change\r\ntxtGridSize.onkeyup = function (e) {\r\n    clearTimeout(onChangeTimeoutId);\r\n    onChangeTimeoutId = setTimeout(function () {\r\n        var newGridSize = parseInt(e.target.value);\r\n        if (newGridSize !== gridSize) {\r\n            gridSize = newGridSize;\r\n            cellSize = W / gridSize;\r\n            GOL.gridSize = gridSize;\r\n            clearCells(bgCtx, W, H);\r\n            drawBgGrid(bgCtx, gridSize, cellSize);\r\n        }\r\n    }, 1000);\r\n};\r\n// Animation interval value change\r\ntxtInterval.onkeyup = function (e) {\r\n    clearTimeout(onChangeTimeoutId);\r\n    onChangeTimeoutId = setTimeout(function () {\r\n        loopInterval = e.target.value;\r\n    }, 1000);\r\n};\r\n// <<<  Game control events\r\n// Window blur stops animation, just in case\r\nwindow.onblur = function () {\r\n    stop();\r\n};\r\n// Handle cell clicks on the grid\r\nvar handleMouseDraw = function (e) {\r\n    if (mouseBtn !== 0) {\r\n        var gridX = Math.floor((e.clientX - rect.left) / cellSize);\r\n        var gridY = Math.floor((e.clientY - rect.top) / cellSize);\r\n        if (gridX !== drawX || gridY !== drawY || mouseBtn !== lastMouseBtn) {\r\n            drawX = gridX;\r\n            drawY = gridY;\r\n            var state = mouseBtn < 0 ? 1 : 0;\r\n            // Toggle a cell's alive state\r\n            GOL.setCellState(gridX, gridY, state);\r\n            clearCells(ctx, W, H);\r\n            drawLiveCells(ctx, GOL.liveCells, cellSize);\r\n        }\r\n        lastMouseBtn = mouseBtn;\r\n    }\r\n};\r\ncanvas.addEventListener('contextmenu', function (e) { return e.preventDefault(); });\r\ncanvas.onmousedown = function (e) {\r\n    mouseBtn = e.button === 0 ? -1 : 1;\r\n    handleMouseDraw(e);\r\n};\r\ncanvas.onmousemove = handleMouseDraw;\r\nwindow.onmouseup = function () { return mouseBtn = 0; };\r\n// Game update loop, receives timestamp from AnimLoopEngine\r\nvar tsFrom = 0;\r\nvar update = function (ts) {\r\n    if (ts === void 0) { ts = 0; }\r\n    if (ts - tsFrom >= loopInterval) {\r\n        GOL.iterate();\r\n        clearCells(ctx, W, H);\r\n        drawLiveCells(ctx, GOL.liveCells, cellSize);\r\n        tsFrom = ts;\r\n    }\r\n};\r\n// Start/stop\r\nvar start = function () {\r\n    engine.start();\r\n    btnToggle.innerHTML = btnTextActive;\r\n    running = true;\r\n};\r\nvar stop = function () {\r\n    engine.stop();\r\n    btnToggle.innerHTML = btnTextInactive;\r\n    running = false;\r\n};\r\n// Draw the BG grid\r\ndrawBgGrid(bgCtx, gridSize, cellSize);\r\n// Add update task to engine\r\nengine.addTask(update);\r\n// Everything is initialized\r\n","var bgColor = '#DDD';\r\n// Draw a single cell\r\nvar drawBgCell = function (ctx, x, y, cellSize) {\r\n    ctx.beginPath();\r\n    ctx.rect(x * cellSize, y * cellSize, cellSize, cellSize);\r\n    ctx.fill();\r\n};\r\n// Clear canvas\r\nexport var clearCells = function (ctx, W, H) {\r\n    ctx.clearRect(0, 0, W, H);\r\n};\r\n// Generate background grid\r\nexport var drawBgGrid = function (ctx, gridSize, cellSize) {\r\n    ctx.fillStyle = bgColor;\r\n    for (var i = 0; i < gridSize; i++) {\r\n        for (var j = 0; j < gridSize; j++) {\r\n            if (i % 2 === 0) {\r\n                if (j % 2 === 0) {\r\n                    drawBgCell(ctx, i, j, cellSize);\r\n                }\r\n            }\r\n            else {\r\n                if (j % 2 !== 0) {\r\n                    drawBgCell(ctx, i, j, cellSize);\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n// Draw live cells\r\nexport var drawLiveCells = function (ctx, liveCells, cellSize) {\r\n    ctx.fillStyle = '#484';\r\n    for (var i in liveCells) {\r\n        for (var j in liveCells[i]) {\r\n            var numI = parseInt(i);\r\n            var numJ = parseInt(j);\r\n            drawBgCell(ctx, numJ, numI, cellSize);\r\n        }\r\n    }\r\n};\r\n","/**\r\n * Simple boilerplate avoidance class for requestAnimationFrame looping\r\n * which runs an array of tasks you specify for frame. It's not clever -\r\n * it assumes you're keeping your frame tasks fast.\r\n */\r\nexport class AnimLoopEngine {\r\n    constructor() {\r\n        this.animate = false;\r\n        this.frameReqId = 0;\r\n        this.frameTasks = [];\r\n        this.lastFrameTaskId = 0;\r\n        this.loop = (ts = 0) => {\r\n            const numTasks = this.frameTasks.length;\r\n            for (let i = 0; i < numTasks; i++) {\r\n                this.frameTasks[i].fn(ts);\r\n            }\r\n            this.frameReqId = requestAnimationFrame(this.loop);\r\n        };\r\n        this.addTasks = this.addTasks.bind(this);\r\n    }\r\n    addTask(task) {\r\n        return this.addTasks([task])[0];\r\n    }\r\n    addTasks(tasks) {\r\n        const createdIds = [];\r\n        if (tasks.length == 0) {\r\n            return createdIds;\r\n        }\r\n        tasks.forEach(task => {\r\n            this.frameTasks.push({ id: this.lastFrameTaskId, fn: task });\r\n            createdIds.push(this.lastFrameTaskId);\r\n            this.lastFrameTaskId++;\r\n        });\r\n        return createdIds;\r\n    }\r\n    deleteTask(taskId) {\r\n        this.frameTasks = this.frameTasks.filter(t => t.id !== taskId);\r\n    }\r\n    start(debugInterval) {\r\n        if (!this.animate) {\r\n            this.animate = true;\r\n            this.loop();\r\n        }\r\n    }\r\n    stop() {\r\n        cancelAnimationFrame(this.frameReqId);\r\n        this.animate = false;\r\n    }\r\n}\r\n//# sourceMappingURL=index.js.map"],"sourceRoot":""}